# CI/Smoke
# CI_SMOKE=1 включаем только для smoke-проверок (см. `make smoke`).
# В обычной работе держим CI_SMOKE=0, чтобы неверный BOT_TOKEN падал сразу и заметно.
CI_SMOKE=0

# UID/GID приложения (Compose / права на /data)
# В проде bot/worker по умолчанию работают как 1000:1000 (пользователь app).
# Можно переопределить, если нужно (например, чтобы совпадало с владельцем данных в volume).
APP_UID=1000
APP_GID=1000

# Telegram
# Format must be digits:string (aiogram validates it).
# В `.env` ОБЯЗАТЕЛЬНО подставь реальный токен бота. Здесь намеренно "валидный по формату", но нерабочий.
BOT_TOKEN=123456789:AABBCCDDEEFFaabbccddeeff1234567890
ADMIN_USER_IDS=

# Access control (Milestone 2)
# 1 = enforce user status/expiry, 0 = allow everyone
ACCESS_CONTROL_ENABLED=0
# default TTL when admin activates user
DEFAULT_USER_TTL_DAYS=30
# warn user/admin this many seconds before expiry (24h = 86400)
ACCESS_WARN_BEFORE_SEC=86400
# how often bot checks for expiring users (sec)
ACCESS_WARN_CHECK_INTERVAL_SEC=3600
# optional: отдельный админ-чат/топик под уведомления
ADMIN_NOTIFY_CHAT_ID=0
# /users admin UI
ADMIN_USERS_PAGE_SIZE=20
ADMIN_SESSION_TTL_SEC=3600


# Storage
# yandex | local
STORAGE_MODE=local

# Yandex Disk (required when STORAGE_MODE=yandex)
YANDEX_OAUTH_TOKEN=
YANDEX_BASE_PATH=/Zkvpr

# Local storage
# Норма: хранить в /data, чтобы данные переживали рестарты и работали одинаково в dev/prod.
LOCAL_STORAGE_ROOT=/data/storage

# Database
# Норма: /data/app.db (SQLite WAL пишет рядом файлы -wal/-shm, поэтому /data должен быть writable для APP_UID:APP_GID).
SQLITE_PATH=/data/app.db

# Catalog
# Размер страницы в inline-навигации каталога (/categories). Меньше кнопок = меньше рисков по лимитам Telegram.
CATALOG_PAGE_SIZE=25
# Периодическая синхронизация каталога в worker (секунды). 0 = выключено, рекомендовано в prod: 3600.
CATALOG_SYNC_INTERVAL_SEC=0
# Страховочный лимит количества узлов, обходимых за одну синхронизацию.
CATALOG_SYNC_MAX_NODES=5000
# Search
SEARCH_PAGE_SIZE=20
# TTL for inline search sessions (sec)
SEARCH_SESSION_TTL_SEC=3600

# Network retries/backoff
NET_RETRY_ATTEMPTS=3
NET_RETRY_MAX_SEC=30

# Worker job attempts
# Maximum number of attempts for a job before marking it as failed (and notifying admins).
JOB_MAX_ATTEMPTS=3


# Queue
REDIS_URL=redis://redis:6379/0

# Local Telegram Bot API Server (опционально, но нужен для обхода лимитов Bot API)
# Cloud Bot API: upload (multipart) 50 MB (10 MB фото), download через getFile 20 MB.
# Local (--local): upload до 2000 MB, download без лимита, поддержка file://.
# When USE_LOCAL_BOT_API=1 bot/worker will use LOCAL_BOT_API_BASE instead of api.telegram.org
USE_LOCAL_BOT_API=0
LOCAL_BOT_API_BASE=http://local-bot-api:8081

# Required to run local-bot-api service (get api_id/api_hash from https://my.telegram.org)
TELEGRAM_API_ID=
TELEGRAM_API_HASH=

# Observability
LOG_LEVEL=INFO

# --- prod (Caddy / HTTPS)
ACME_EMAIL=
# METRICS_PASS must be a Caddy basicauth hash (use: caddy hash-password --plaintext "..." )
METRICS_USER=metrics
METRICS_PASS=

# Image for prod compose (your workflow expects it in .env)
IMAGE=ghcr.io/nikmagrus-creator/adaspeas_docs:latest
