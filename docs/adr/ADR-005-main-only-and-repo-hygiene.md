# ADR-005: Репозиторий только с веткой main + гигиена env

Статус: Accepted  
Дата: 2026-02-07 12:30 MSK

## Контекст
Мы ведём этот репозиторий как «документационный монорельс»: одна ветка `main`, без PR/merge/cherry-pick по возможности.

Причины:
- минимизировать конфликты в Markdown (особенно в `docs/CHATLOG_RU.md` и операционных файлах);
- упростить деплой (на VPS делаем `git pull --ff-only` и без «историй из PR»);
- не тратить время на поддержку зависимых бранчей (dependabot) и шаблонов PR.

Параллельно нужен жёсткий контроль секретов:
- файлы `.env*` не должны попадать в git,
- единственное исключение: `.env.example` как безопасный шаблон.

## Решение
1) Политика веток:
- `main` единственная «живая» ветка.
- Любые появившиеся ветки (включая dependabot) удаляются.
- В repo удалены `.github/dependabot.yml` и PR template, чтобы не провоцировать PR-процессы.

2) Гигиена env:
- `.env` и любые `.env.*` игнорируются через `.gitignore`.
- `.env.example` обязателен в репозитории (шаблон без секретов).
- CI проверяет: `.env.example` трекается, а любые другие `.env*` в индексе запрещены.

## Последствия
Плюсы:
- меньше конфликтов, быстрее обновления, проще поддержка;
- на VPS деплой детерминированный (fast-forward);
- снижен риск утечки секретов.

Минусы:
- обновления зависимостей (как зависимые ветки) не приходят автоматически;
- если кто-то всё же начинает cherry-pick/merge, придётся руками разруливать конфликты.

## Операционные заметки
- Процедура удаления лишних веток описана в `docs/OPS_RUNBOOK_RU.md`.
- Если dependabot создаёт ветки даже без файла конфигурации, его нужно выключить в настройках репозитория GitHub.
