# WORKFLOW_CONTRACT (RU): правила работы с этим проектом в чате

Актуально на: 2026-02-04 13:45 UTC

Цель: чтобы новый чат/ИИ мог работать с проектом **без уточнений** и без “мусора” в истории.

## 0) Настройки окружения (обязательные по умолчанию)
- Source of Truth для работы из чата (всегда начинать отсюда): https://github.com/nikmagrus-creator/adaspeas_docs
- Вложения потенциально устаревшие; если есть сомнения или что-то не грузится/не совпадает — требовать актуальное вложение в чате.
- Локальный репозиторий: `/home/nik/projects/adaspeas`
- Папка архивов: `/media/nik/0C30B3CF30B3BE50/Загрузки`
- Основная папка каталога на Яндекс.Диске: `Zkvpr` (не `Adaspeas`).
- Ветка по умолчанию: `main`

## 1) Anti-spam: что нельзя писать в чат
В чате **нельзя** публиковать:
- код, конфиги, диффы, “портянки” команд
- содержимое файлов целиком (кроме очень кратких фрагментов по запросу)

Вложения в чат:
- Загружаем **только** то, что ассистент не может прочитать в репозитории (например: закрытые/внешние файлы).
- Все изменения в репозитории доставляются архивом по протоколу ниже.

В чате можно:
- план/решения/список затрагиваемых файлов/риски
- итоговое **краткое** резюме изменений

## 2) Формат результата любой правки (обязательный)
Любая правка поставляется так:
1) Архив с изменениями
2) Сразу после архива — **один** блок команд:
   - распаковка в репозиторий с заменой
   - удаление лишнего (если требуется)
   - `git add -A`, `git commit`, `git push`

### 2.1) Обязательные предохранители команд
- Перед применением: проверка, что репо чистый (`git status --porcelain` пусто)
- Распаковка **всегда** с `--strip-components=1` (чтобы не ловить вложенные папки)
- После применения: репо должен остаться чистым (кроме новых изменений перед коммитом)

## 3) Дисциплина файлов (не плодим)
- **Запрещено** создавать новые файлы, если изменения можно внести в существующие документы.
- Новый файл допускается только если:
  1) появляется новый тип артефакта (например: INDEX, CONTRACT, CHANGELOG, ADR), или
  2) существующий файл перестал быть читаем (смешивает разные цели).
- Если создан новый файл: **обязателен** апдейт `docs/INDEX_RU.md` + запись причины в “Истории изменений”.

## 4) Дисциплина обновлений документов (дата/время/история)
Если меняется смысл документа (не опечатка):
- обновить строку `Актуально на: YYYY-MM-DD HH:MM UTC`
- добавить строку в таблицу “История изменений” **в этом же документе**
Если меняется публичный контракт/поведение системы:
- дополнительно обновить `CHANGELOG.md`

## 5) Мини-checklist перед изменениями (симуляция)
Перед выдачей архива убедиться:
- пути корректны (repo/archives)
- архив распакуется в корень проекта и не создаст лишний уровень папок
- действия идемпотентны: повтор применения не ломает репо
- если нужно удаление — оно включено в команды после архива

## 6) Фиксация договоренностей
- Любая новая договоренность/правило из чата перефразируется и фиксируется в подходящем документе (обычно здесь, либо в PRD/TECH/OPS).
- Если меняется смысл документа (не опечатка): обновить строку "Актуально на" и добавить строку в таблицу "История изменений".

## История изменений
| Дата/время (UTC) | Автор | Тип | Кратко | Commit/PR |
|---|---|---|---|---|
| 2026-02-04 12:00 UTC | ChatGPT | contract | Зафиксирован протокол работы “архив + команды”, запрет мусора, дисциплина файлов и истории | |
| 2026-02-04 13:45 UTC | ChatGPT | contract | Уточнено: всегда начинать с GitHub docs-репозитория; вложения считать потенциально устаревшими | |
